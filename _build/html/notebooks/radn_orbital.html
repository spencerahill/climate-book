

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Orbital variations, insolation, and the ice ages &#8212; Earth System Modelling</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/radn_orbital';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chapter 3: Climate feedbacks" href="../content_feedbacks.html" />
    <link rel="prev" title="Radiative-Convective Equilibrium" href="radn_rce.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Earth System Modelling - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Earth System Modelling - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../content_radiation.html">Chapter 2: Energy Balance and Forcing</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="radn_insolation.html">Insolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="radn_radeq.html">Radiative Equilibrium</a></li>
<li class="toctree-l2"><a class="reference internal" href="radn_rce.html">Radiative-Convective Equilibrium</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Orbital variations, insolation, and the ice ages</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../content_feedbacks.html">Chapter 3: Climate feedbacks</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="clim_EBM_0D_ice_feedback.html">Ice albedo feedback in the 0D energy balance model</a></li>
<li class="toctree-l2"><a class="reference internal" href="clim_EBM_water_vapor.html">Adding water vapor feedback to the grey model of the atmosphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="clim_daisy_world.html">Biogeophysical feedbacks: Daisy World</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../content_modelling.html">Chapter 3: Climate models</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="mod_climate-system-models.html">The climate system and climate models</a></li>
<li class="toctree-l2"><a class="reference internal" href="mod_advection.html">Focus on advection</a></li>
<li class="toctree-l2"><a class="reference internal" href="mod_CMIP_IPCC_temperature_trends.html">Coupled Model Intercomparison Project (CMIP)</a></li>

</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gl/tompkins%2Fearth-system-modelling/master?urlpath=tree/notebooks/radn_orbital.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>



<a href="https://gitlab.com/tompkins/earth-system-modelling" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-gitlab"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/radn_orbital.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Orbital variations, insolation, and the ice ages</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-ice-ages">1. The ice ages</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extent-of-glaciation">Extent of glaciation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pacing-of-ice-ages-evidence-from-ocean-sediments">Pacing of ice ages: evidence from ocean sediments</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-the-astronomical-theory-of-the-ice-ages">2. Introducing the astronomical theory of the ice ages</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-milankovitch-hypothesis">The Milankovitch hypothesis</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ellipses-and-orbits">3. Ellipses and orbits</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#perihelion-and-aphelion">Perihelion and Aphelion</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eccentricity">Eccentricity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#obliquity">Obliquity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#longitude-of-perihelion-and-precession-of-the-equinoxes">Longitude of perihelion and precession of the equinoxes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-three-orbital-parameters">The three orbital parameters</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#past-orbital-variations">4. Past orbital variations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#timescales-of-orbital-variation">Timescales of orbital variation:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-climlab-to-calculate-insolation-for-arbitrary-orbital-parameters">5. Using <code class="docutils literal notranslate"><span class="pre">climlab</span></code> to calculate insolation for arbitrary orbital parameters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#an-example-zero-obliquity">An example: zero obliquity</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#past-changes-in-insolation-investigating-the-milankovitch-hypothesis">6. Past changes in insolation: investigating the Milankovitch hypothesis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-insolation-at-10-kyr-and-23-kyr">Comparing insolation at 10 kyr and 23 kyr</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">EXERCISE</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-effects-of-orbital-variations-on-insolation">7. Understanding the effects of orbital variations on insolation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">8. Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#credits">Credits</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="orbital-variations-insolation-and-the-ice-ages">
<h1>Orbital variations, insolation, and the ice ages<a class="headerlink" href="#orbital-variations-insolation-and-the-ice-ages" title="Permalink to this heading">#</a></h1>
<p>This notebook is part of <a class="reference external" href="https://brian-rose.github.io/ClimateLaboratoryBook">The Climate Laboratory</a> by <a class="reference external" href="http://www.atmos.albany.edu/facstaff/brose/index.html">Brian E. J. Rose</a>, University at Albany.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">climlab</span> <span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.0.0 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with &#39;pybind11&gt;=2.12&#39;.

If you are a user of the module, the easiest solution will be to
downgrade to &#39;numpy&lt;2&#39; or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File &quot;/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py&quot;, line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File &quot;/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py&quot;, line 87, in _run_code
    exec(code, run_globals)
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/ipykernel_launcher.py&quot;, line 17, in &lt;module&gt;
    app.launch_new_instance()
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/traitlets/config/application.py&quot;, line 1043, in launch_instance
    app.start()
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/ipykernel/kernelapp.py&quot;, line 725, in start
    self.io_loop.start()
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/tornado/platform/asyncio.py&quot;, line 215, in start
    self.asyncio_loop.run_forever()
  File &quot;/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/base_events.py&quot;, line 596, in run_forever
    self._run_once()
  File &quot;/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/base_events.py&quot;, line 1890, in _run_once
    handle._run()
  File &quot;/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/events.py&quot;, line 80, in _run
    self._context.run(self._callback, *self._args)
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/ipykernel/kernelbase.py&quot;, line 513, in dispatch_queue
    await self.process_one()
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/ipykernel/kernelbase.py&quot;, line 502, in process_one
    await dispatch(*args)
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/ipykernel/kernelbase.py&quot;, line 409, in dispatch_shell
    await result
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/ipykernel/kernelbase.py&quot;, line 729, in execute_request
    reply_content = await reply_content
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/ipykernel/ipkernel.py&quot;, line 422, in do_execute
    res = shell.run_cell(
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/ipykernel/zmqshell.py&quot;, line 540, in run_cell
    return super().run_cell(*args, **kwargs)
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/IPython/core/interactiveshell.py&quot;, line 2961, in run_cell
    result = self._run_cell(
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/IPython/core/interactiveshell.py&quot;, line 3016, in _run_cell
    result = runner(coro)
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/IPython/core/async_helpers.py&quot;, line 129, in _pseudo_sync_runner
    coro.send(None)
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/IPython/core/interactiveshell.py&quot;, line 3221, in run_cell_async
    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/IPython/core/interactiveshell.py&quot;, line 3400, in run_ast_nodes
    if await self.run_code(code, result, async_=asy):
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/IPython/core/interactiveshell.py&quot;, line 3460, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File &quot;/var/folders/5f/gmzfbr6d0cbb3tn3_mkpdfnh0000gq/T/ipykernel_62160/2000417862.py&quot;, line 1, in &lt;module&gt;
    get_ipython().run_line_magic(&#39;matplotlib&#39;, &#39;inline&#39;)
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/IPython/core/interactiveshell.py&quot;, line 2369, in run_line_magic
    result = fn(*args, **kwargs)
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/IPython/core/magics/pylab.py&quot;, line 99, in matplotlib
    gui, backend = self.shell.enable_matplotlib(args.gui.lower() if isinstance(args.gui, str) else args.gui)
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/IPython/core/interactiveshell.py&quot;, line 3540, in enable_matplotlib
    from matplotlib_inline.backend_inline import configure_inline_support
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/matplotlib_inline/__init__.py&quot;, line 1, in &lt;module&gt;
    from . import backend_inline, config  # noqa
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/matplotlib_inline/backend_inline.py&quot;, line 6, in &lt;module&gt;
    import matplotlib
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/matplotlib/__init__.py&quot;, line 113, in &lt;module&gt;
    from . import _api, _version, cbook, _docstring, rcsetup
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/matplotlib/rcsetup.py&quot;, line 27, in &lt;module&gt;
    from matplotlib.colors import Colormap, is_color_like
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/matplotlib/colors.py&quot;, line 56, in &lt;module&gt;
    from matplotlib import _api, _cm, cbook, scale
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/matplotlib/scale.py&quot;, line 22, in &lt;module&gt;
    from matplotlib.ticker import (
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/matplotlib/ticker.py&quot;, line 138, in &lt;module&gt;
    from matplotlib import transforms as mtransforms
  File &quot;/Users/tompkins/Library/Python/3.9/lib/python/site-packages/matplotlib/transforms.py&quot;, line 49, in &lt;module&gt;
    from matplotlib._path import (
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="ne">AttributeError</span>: _ARRAY_API not found
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_line_magic</span><span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;inline&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="nn">File ~/Library/Python/3.9/lib/python/site-packages/IPython/core/interactiveshell.py:2369,</span> in <span class="ni">InteractiveShell.run_line_magic</span><span class="nt">(self, magic_name, line, _stack_depth)</span>
<span class="g g-Whitespace">   </span><span class="mi">2367</span>     <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;local_ns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_local_scope</span><span class="p">(</span><span class="n">stack_depth</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2368</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">builtin_trap</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2369</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2371</span> <span class="c1"># The code below prevents the output from being displayed</span>
<span class="g g-Whitespace">   </span><span class="mi">2372</span> <span class="c1"># when using magics with decodator @output_can_be_silenced</span>
<span class="g g-Whitespace">   </span><span class="mi">2373</span> <span class="c1"># when the last Python token in the expression is a &#39;;&#39;.</span>
<span class="g g-Whitespace">   </span><span class="mi">2374</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">magic</span><span class="o">.</span><span class="n">MAGIC_OUTPUT_CAN_BE_SILENCED</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>

<span class="nn">File ~/Library/Python/3.9/lib/python/site-packages/IPython/core/magics/pylab.py:99,</span> in <span class="ni">PylabMagics.matplotlib</span><span class="nt">(self, line)</span>
<span class="g g-Whitespace">     </span><span class="mi">97</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available matplotlib backends: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">backends_list</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">99</span>     <span class="n">gui</span><span class="p">,</span> <span class="n">backend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shell</span><span class="o">.</span><span class="n">enable_matplotlib</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">100</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_show_matplotlib_backend</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>

<span class="nn">File ~/Library/Python/3.9/lib/python/site-packages/IPython/core/interactiveshell.py:3540,</span> in <span class="ni">InteractiveShell.enable_matplotlib</span><span class="nt">(self, gui)</span>
<span class="g g-Whitespace">   </span><span class="mi">3519</span> <span class="k">def</span> <span class="nf">enable_matplotlib</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gui</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">3520</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Enable interactive matplotlib and inline figure support.</span>
<span class="g g-Whitespace">   </span><span class="mi">3521</span><span class="sd"> </span>
<span class="g g-Whitespace">   </span><span class="mi">3522</span><span class="sd">     This takes the following steps:</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">3538</span><span class="sd">         display figures inline.</span>
<span class="g g-Whitespace">   </span><span class="mi">3539</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">3540</span>     <span class="kn">from</span> <span class="nn">matplotlib_inline.backend_inline</span> <span class="kn">import</span> <span class="n">configure_inline_support</span>
<span class="g g-Whitespace">   </span><span class="mi">3542</span>     <span class="kn">from</span> <span class="nn">IPython.core</span> <span class="kn">import</span> <span class="n">pylabtools</span> <span class="k">as</span> <span class="n">pt</span>
<span class="g g-Whitespace">   </span><span class="mi">3543</span>     <span class="n">gui</span><span class="p">,</span> <span class="n">backend</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">find_gui_and_backend</span><span class="p">(</span><span class="n">gui</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pylab_gui_select</span><span class="p">)</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">Library</span><span class="o">/</span><span class="n">Python</span><span class="o">/</span><span class="mf">3.9</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib_inline</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">backend_inline</span><span class="p">,</span> <span class="n">config</span>  <span class="c1"># noqa</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;0.1.6&quot;</span>  <span class="c1"># noqa</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">Library</span><span class="o">/</span><span class="n">Python</span><span class="o">/</span><span class="mf">3.9</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib_inline</span><span class="o">/</span><span class="n">backend_inline</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">6</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;A matplotlib backend for publishing figures via display_data&quot;&quot;&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1"># Copyright (c) IPython Development Team.</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1"># Distributed under the terms of the BSD 3-Clause License.</span>
<span class="ne">----&gt; </span><span class="mi">6</span> <span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">colors</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="kn">from</span> <span class="nn">matplotlib.backends</span> <span class="kn">import</span> <span class="n">backend_agg</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">Library</span><span class="o">/</span><span class="n">Python</span><span class="o">/</span><span class="mf">3.9</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">113</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span> <span class="kn">from</span> <span class="nn">packaging.version</span> <span class="kn">import</span> <span class="n">parse</span> <span class="k">as</span> <span class="n">parse_version</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span> <span class="c1"># cbook must import matplotlib only within function</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span> <span class="c1"># definitions, so it is safe to import from it here.</span>
<span class="ne">--&gt; </span><span class="mi">113</span> <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_api</span><span class="p">,</span> <span class="n">_version</span><span class="p">,</span> <span class="n">cbook</span><span class="p">,</span> <span class="n">_docstring</span><span class="p">,</span> <span class="n">rcsetup</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span> <span class="kn">from</span> <span class="nn">matplotlib.cbook</span> <span class="kn">import</span> <span class="n">sanitize_sequence</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span> <span class="kn">from</span> <span class="nn">matplotlib._api</span> <span class="kn">import</span> <span class="n">MatplotlibDeprecationWarning</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">Library</span><span class="o">/</span><span class="n">Python</span><span class="o">/</span><span class="mf">3.9</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">rcsetup</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">27</span>
<span class="g g-Whitespace">     </span><span class="mi">25</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">_api</span><span class="p">,</span> <span class="n">cbook</span>
<span class="g g-Whitespace">     </span><span class="mi">26</span> <span class="kn">from</span> <span class="nn">matplotlib.cbook</span> <span class="kn">import</span> <span class="n">ls_mapper</span>
<span class="ne">---&gt; </span><span class="mi">27</span> <span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">Colormap</span><span class="p">,</span> <span class="n">is_color_like</span>
<span class="g g-Whitespace">     </span><span class="mi">28</span> <span class="kn">from</span> <span class="nn">matplotlib._fontconfig_pattern</span> <span class="kn">import</span> <span class="n">parse_fontconfig_pattern</span>
<span class="g g-Whitespace">     </span><span class="mi">29</span> <span class="kn">from</span> <span class="nn">matplotlib._enums</span> <span class="kn">import</span> <span class="n">JoinStyle</span><span class="p">,</span> <span class="n">CapStyle</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">Library</span><span class="o">/</span><span class="n">Python</span><span class="o">/</span><span class="mf">3.9</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">colors</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">56</span>
<span class="g g-Whitespace">     </span><span class="mi">54</span> <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="g g-Whitespace">     </span><span class="mi">55</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="ne">---&gt; </span><span class="mi">56</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">_api</span><span class="p">,</span> <span class="n">_cm</span><span class="p">,</span> <span class="n">cbook</span><span class="p">,</span> <span class="n">scale</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span> <span class="kn">from</span> <span class="nn">._color_data</span> <span class="kn">import</span> <span class="n">BASE_COLORS</span><span class="p">,</span> <span class="n">TABLEAU_COLORS</span><span class="p">,</span> <span class="n">CSS4_COLORS</span><span class="p">,</span> <span class="n">XKCD_COLORS</span>
<span class="g g-Whitespace">     </span><span class="mi">60</span> <span class="k">class</span> <span class="nc">_ColorMapping</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">Library</span><span class="o">/</span><span class="n">Python</span><span class="o">/</span><span class="mf">3.9</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">scale</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">22</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span> <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">_api</span><span class="p">,</span> <span class="n">_docstring</span>
<span class="ne">---&gt; </span><span class="mi">22</span> <span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">23</span>     <span class="n">NullFormatter</span><span class="p">,</span> <span class="n">ScalarFormatter</span><span class="p">,</span> <span class="n">LogFormatterSciNotation</span><span class="p">,</span> <span class="n">LogitFormatter</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">24</span>     <span class="n">NullLocator</span><span class="p">,</span> <span class="n">LogLocator</span><span class="p">,</span> <span class="n">AutoLocator</span><span class="p">,</span> <span class="n">AutoMinorLocator</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">25</span>     <span class="n">SymmetricalLogLocator</span><span class="p">,</span> <span class="n">AsinhLocator</span><span class="p">,</span> <span class="n">LogitLocator</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">26</span> <span class="kn">from</span> <span class="nn">matplotlib.transforms</span> <span class="kn">import</span> <span class="n">Transform</span><span class="p">,</span> <span class="n">IdentityTransform</span>
<span class="g g-Whitespace">     </span><span class="mi">29</span> <span class="k">class</span> <span class="nc">ScaleBase</span><span class="p">:</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">Library</span><span class="o">/</span><span class="n">Python</span><span class="o">/</span><span class="mf">3.9</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">ticker</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">138</span>
<span class="g g-Whitespace">    </span><span class="mi">136</span> <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="g g-Whitespace">    </span><span class="mi">137</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">_api</span><span class="p">,</span> <span class="n">cbook</span>
<span class="ne">--&gt; </span><span class="mi">138</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">transforms</span> <span class="k">as</span> <span class="n">mtransforms</span>
<span class="g g-Whitespace">    </span><span class="mi">140</span> <span class="n">_log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">142</span> <span class="n">__all__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;TickHelper&#39;</span><span class="p">,</span> <span class="s1">&#39;Formatter&#39;</span><span class="p">,</span> <span class="s1">&#39;FixedFormatter&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">143</span>            <span class="s1">&#39;NullFormatter&#39;</span><span class="p">,</span> <span class="s1">&#39;FuncFormatter&#39;</span><span class="p">,</span> <span class="s1">&#39;FormatStrFormatter&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">144</span>            <span class="s1">&#39;StrMethodFormatter&#39;</span><span class="p">,</span> <span class="s1">&#39;ScalarFormatter&#39;</span><span class="p">,</span> <span class="s1">&#39;LogFormatter&#39;</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">150</span>            <span class="s1">&#39;MultipleLocator&#39;</span><span class="p">,</span> <span class="s1">&#39;MaxNLocator&#39;</span><span class="p">,</span> <span class="s1">&#39;AutoMinorLocator&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span>            <span class="s1">&#39;SymmetricalLogLocator&#39;</span><span class="p">,</span> <span class="s1">&#39;AsinhLocator&#39;</span><span class="p">,</span> <span class="s1">&#39;LogitLocator&#39;</span><span class="p">)</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">Library</span><span class="o">/</span><span class="n">Python</span><span class="o">/</span><span class="mf">3.9</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">transforms</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">49</span>
<span class="g g-Whitespace">     </span><span class="mi">46</span> <span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">inv</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">_api</span>
<span class="ne">---&gt; </span><span class="mi">49</span> <span class="kn">from</span> <span class="nn">matplotlib._path</span> <span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">50</span>     <span class="n">affine_transform</span><span class="p">,</span> <span class="n">count_bboxes_overlapping_bbox</span><span class="p">,</span> <span class="n">update_path_extents</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">51</span> <span class="kn">from</span> <span class="nn">.path</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span> <span class="n">DEBUG</span> <span class="o">=</span> <span class="kc">False</span>

<span class="ne">ImportError</span>: numpy.core.multiarray failed to import
</pre></div>
</div>
</div>
</div>
<section id="the-ice-ages">
<h2>1. The ice ages<a class="headerlink" href="#the-ice-ages" title="Permalink to this heading">#</a></h2>
<p>Recent Earth history (past few million years) has been dominated by the repeated growth and retreat of large continental ice sheets, mostly over the land masses of the Northern Hemisphere.</p>
<section id="extent-of-glaciation">
<h3>Extent of glaciation<a class="headerlink" href="#extent-of-glaciation" title="Permalink to this heading">#</a></h3>
<p>The images below show typical maximum extents of the ice sheets during recent glaciations (grey) compared with present-day ice sheets (black)</p>
<img src='http://upload.wikimedia.org/wikipedia/commons/thumb/e/ef/Iceage_north-intergl_glac_hg.png/480px-Iceage_north-intergl_glac_hg.png'><img src='http://upload.wikimedia.org/wikipedia/commons/thumb/4/44/Iceage_south-intergl_glac_hg.png/480px-Iceage_south-intergl_glac_hg.png'><blockquote>
<div><p>Hannes Grobe/AWI, <a class="reference external" href="http://commons.wikimedia.org/wiki/File:Iceage_north-intergl_glac_hg.png">http://commons.wikimedia.org/wiki/File:Iceage_north-intergl_glac_hg.png</a></p>
</div></blockquote>
<p><a id='icevolumeseries'></a></p>
</section>
<section id="pacing-of-ice-ages-evidence-from-ocean-sediments">
<h3>Pacing of ice ages: evidence from ocean sediments<a class="headerlink" href="#pacing-of-ice-ages-evidence-from-ocean-sediments" title="Permalink to this heading">#</a></h3>
<p>The figure below shows a global record of <strong>oxygen isotopes</strong> recorded in the shells of marine organisms. This record tells us primarily about variations in <strong>global ice volume</strong>  because the net evaporation of water from the oceans to build up the ice sheets leaves the oceans enriched in heavier isotopes.</p>
<p>The x axis is plotted in <strong>Thousands of years before present</strong> (present-day is at zero on the left).</p>
<p><img alt="Lisiecki_Raymo_Fig.4top.png" src="notebooks/attachment:Lisiecki_Raymo_Fig.4top.png" /></p>
<blockquote>
<div><p>Lisiecki, L. E. and Raymo, M. E. (2005). A Pliocene-Pleistocene stack of 57 globally distributed benthic 18O records. Paleoceanog., 20.</p>
</div></blockquote>
<p>The ice ages (times of extensive glaciation and high ocean <span class="math notranslate nohighlight">\(\delta^{18}\)</span>O) do not seem to be random fluctations. They have come and gone (approximately) periodically, somewhat like the seasons.</p>
<p><strong>Spectral analysis</strong> of such records reveals peaks at some special frequencies:</p>
<div>
<img src="attachment:ImbrieImbrie_Fig42.png" width="300"/>
</div><blockquote>
<div><p>Imbrie, J. and Imbrie, K. P. (1986). Ice Ages: Solving the Mystery. Harvard University Press, Cambridge, Massachusetts.</p>
</div></blockquote>
<p>The peaks noted on this figure are special because they correspond to frequencies of variations in Earths orbital parameters, as we will see.</p>
<p>These kind of results became available in the 1970s for the first time, because ocean sediment cores allowed a sufficiently detailed look into the past to use time series analysis methods on them, e.g. to compute spectra.</p>
<p>The presence of peaks in the spectrum at orbital frequencies was seen as convincing evidence that the so-called <strong>astronomical theory of the ice ages</strong> was (at least partially) correct.</p>
</section>
</section>
<section id="introducing-the-astronomical-theory-of-the-ice-ages">
<h2>2. Introducing the astronomical theory of the ice ages<a class="headerlink" href="#introducing-the-astronomical-theory-of-the-ice-ages" title="Permalink to this heading">#</a></h2>
<p>The <strong>Astronomical Theory</strong> of climate and the ice ages looks to the <strong>regular, predictable variations in the Earths orbit around the Sun</strong> as the driving force for the growth and melt of the great ice sheets. Such theories have been discussed since long before there was any evidence about the timing of past glaciations.</p>
<p>Last time we saw that insolation is NOT perfectly symmetrically distributed between the two hemispheres and seasons.</p>
<p>To refresh our memory, lets use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">climlab</span><span class="o">.</span><span class="n">solar</span><span class="o">.</span><span class="n">insolation</span><span class="o">.</span><span class="n">daily_insolation</span><span class="p">()</span>
</pre></div>
</div>
<p>to compare the maximum insolation received at the North Pole (at its summer solstice) and the South Pole (at its summer solstice).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">climlab.solar.insolation</span> <span class="kn">import</span> <span class="n">daily_insolation</span>
<span class="n">days</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">const</span><span class="o">.</span><span class="n">days_per_year</span><span class="p">,</span> <span class="mi">365</span><span class="p">)</span>

<span class="n">Qnorth</span> <span class="o">=</span> <span class="n">daily_insolation</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span><span class="n">days</span><span class="p">)</span>
<span class="n">Qsouth</span> <span class="o">=</span> <span class="n">daily_insolation</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="n">days</span><span class="p">)</span>
<span class="n">Qtrieste</span> <span class="o">=</span> <span class="n">daily_insolation</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="n">days</span><span class="p">)</span>
<span class="n">Qeq</span> <span class="o">=</span> <span class="n">daily_insolation</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">days</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Daily average insolation at summer solstice:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;North Pole: </span><span class="si">%0.2f</span><span class="s1"> W/m2.&#39;</span> <span class="o">%</span><span class="k">np</span>.max(Qnorth))
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;South Pole: </span><span class="si">%0.2f</span><span class="s1"> W/m2.&#39;</span> <span class="o">%</span><span class="k">np</span>.max(Qsouth))


<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">days</span><span class="p">,</span><span class="n">Qnorth</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;North Pole&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">days</span><span class="p">,</span><span class="n">Qtrieste</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Trieste&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">days</span><span class="p">,</span><span class="n">Qeq</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Equator&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Daily average insolation at summer solstice:
North Pole: 525.31 W/m2.
South Pole: 562.03 W/m2.
</pre></div>
</div>
<img alt="../_images/a091ec3f070af571280eabda52a5e3ad2d0c230ecb26c0f9648131f69d86d6fc.png" src="../_images/a091ec3f070af571280eabda52a5e3ad2d0c230ecb26c0f9648131f69d86d6fc.png" />
</div>
</div>
<p>These asymmetries arise because of the detailed shape of the orbit of the Earth around the Sun and the tilt of the Earths axis of rotation.</p>
<p>As these orbitals details change over time, there are significant changes in the distribution of sunlight over the seasons and latitudes.</p>
<section id="the-milankovitch-hypothesis">
<h3>The Milankovitch hypothesis<a class="headerlink" href="#the-milankovitch-hypothesis" title="Permalink to this heading">#</a></h3>
<p>Version of the astronomical theory have been debated for at least 150 years.</p>
<p>The most popular flavor has been the so-called <strong>Milankovitch hypothesis</strong>:</p>
<blockquote>
<div><p>Ice sheets grow during periods of <em>weak summer insolation</em> in the Northern high latitudes.</p>
</div></blockquote>
<p>The idea is that for an ice sheet to grow, seasonal snow must survive through the summer. Milankovitch therefore focussed on the factors determining the climatic conditions during <strong>summer</strong>.</p>
<hr class="docutils" />
<p><a id='section3'></a></p>
</section>
</section>
<section id="ellipses-and-orbits">
<h2>3. Ellipses and orbits<a class="headerlink" href="#ellipses-and-orbits" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>First, watch this neat animation from <a class="reference external" href="http://www.people.fas.harvard.edu/~phuybers">Peter Huybers</a> (Harvard University):</p>
<p><a class="reference external" href="http://www.people.fas.harvard.edu/~phuybers/Inso/Orbit.mv4">http://www.people.fas.harvard.edu/~phuybers/Inso/Orbit.mv4</a></p>
<p>Watch carefully and note the three ways that the orbit is varying simultaneously.</p>
<p>From Professor Huybers web page:</p>
<blockquote>
<div><p>A movie depicting Earths changing orbit over the last 100Ky. The orientation is such that spring equinox (indicated by a vertical bar) is directly to the front with the sun behind it. Northern Hemisphere summer is to our right, and Northern Hemisphere winter is to the left. The apsidal (dashed) line connects perihelion (Earths closest approach to the sun) to aphelion (the point when Earth is furthest from the sun). The rotaion of the apsidal line occurs because of the precession of the equinoxes and has a roughly twenty-two thousand year period. The semi-circle around the Earth indicates the location of the equator and the straight line is the polar axis. Obliquity is defined as the angle beetween the orbital and equatorial planes. The variations in Earths obliquity and the eccentricity of Earths orbit have both been increased in magnitude by a factor of ten. Also, the Earths angular velocity has been decreased by a factor of five thousand. Note that Earths angular velocity is slowest at aphelion and fastest at perihelion.</p>
</div></blockquote>
<p>The Earths orbit around the Sun traces out an <strong>ellipse</strong>, with the Sun at one focal point.</p>
<p><img alt="esm_part1_orbit_earth.png" src="notebooks/attachment:esm_part1_orbit_earth.png" /></p>
<section id="perihelion-and-aphelion">
<h3>Perihelion and Aphelion<a class="headerlink" href="#perihelion-and-aphelion" title="Permalink to this heading">#</a></h3>
<p>The point in the orbit that is <strong>closest to the sun</strong> is called <strong>Perihelion</strong>.
The farthest point is called <strong>Aphelion</strong>.</p>
<p>Distances (present-day):</p>
<ul class="simple">
<li><p>Perihelion,  <span class="math notranslate nohighlight">\( d_p = 1.47 \times 10^{11}\)</span> m</p></li>
<li><p>Aphelion,  <span class="math notranslate nohighlight">\( d_a = 1.52 \times 10^{11}\)</span> m</p></li>
</ul>
</section>
<section id="eccentricity">
<h3>Eccentricity<a class="headerlink" href="#eccentricity" title="Permalink to this heading">#</a></h3>
<p>The eccentricity of the orbit is defined as
$<span class="math notranslate nohighlight">\( e = \frac{d_a-d_p}{d_a+d_p} \)</span>$</p>
<p>So for present-day values, <span class="math notranslate nohighlight">\(e = 0.017 = 1.7\%\)</span></p>
<p>Earths orbit is nearly circular, but not quite!</p>
<p>(What value of <span class="math notranslate nohighlight">\(e\)</span> would a purely circular orbit have?)</p>
<p>As the Earth travels around its orbit, the <strong>distance to the sun varies</strong>. The energy flux (W m<span class="math notranslate nohighlight">\(^{-2}\)</span>) is larger when the Earth is closer to the sun (i.e. near perihelion).</p>
<p>At present, perihelion occurs on January 3. This is very close to the Northern Hemisphere winter solstice (Dec. 21).</p>
<p><strong>The Earth actually receives MORE total sunlight during Northern Winter than during Northern Summer.</strong></p>
<p>It is thus critical to understand the relative timing of our seasons (which are determined by the axial tilt or obliquity) and the perehelion.</p>
</section>
<section id="obliquity">
<h3>Obliquity<a class="headerlink" href="#obliquity" title="Permalink to this heading">#</a></h3>
<p>The obliquity <span class="math notranslate nohighlight">\(\Phi\)</span> is the <strong>tilt of the Earths axis of rotation with respect to a line normal to the plane of the Earths orbit around the Sun.</strong></p>
<p>Currently <span class="math notranslate nohighlight">\(\Phi = 23.5^\circ\)</span></p>
<p>Obliquity is the fundamental reason we have seasons, and would have seasons even with a perfectly circular orbit (<span class="math notranslate nohighlight">\(e=0\)</span>)</p>
<p>Higher obliquity means:</p>
<ul class="simple">
<li><p>more summertime insolation at the poles</p></li>
<li><p>less wintertime insolation in mid-latitudes</p></li>
</ul>
</section>
<section id="longitude-of-perihelion-and-precession-of-the-equinoxes">
<h3>Longitude of perihelion and precession of the equinoxes<a class="headerlink" href="#longitude-of-perihelion-and-precession-of-the-equinoxes" title="Permalink to this heading">#</a></h3>
<p>The <strong>longitude of perihelion</strong> is defined as the angle <span class="math notranslate nohighlight">\(\Lambda\)</span> between the Earth-Sun line at vernal equinox and the line from the Sun to perihelion (see sketch).</p>
<p>The current value is <span class="math notranslate nohighlight">\(\Lambda = 281^\circ\)</span> (perihelion on January 3, shortly after NH winter solstice).</p>
<p>We call the gradual change over time of the longitude of perihelion the <strong>precession of the equinoxes</strong> (or just precession).  It is the <strong>gradual change in the time of year at which the Earth is closest to the Sun</strong>.</p>
<p>It is important to understand that eccentricity modulates the precession. <em>Highly eccentric orbits lead to larger differences in the seasonal distribution of insolation.</em></p>
<p>We quantify this with the <strong>precessional parameter</strong></p>
<div class="math notranslate nohighlight">
\[ e \sin \Lambda \]</div>
<p>Large positive precessional parameter = Excess insolation during summer in the northern hemisphere.</p>
</section>
<section id="the-three-orbital-parameters">
<h3>The three orbital parameters<a class="headerlink" href="#the-three-orbital-parameters" title="Permalink to this heading">#</a></h3>
<p>We have just identified three parameters that control the seasonal and latitudinal distribution of insolation: <span class="math notranslate nohighlight">\(e, \Lambda, \Phi\)</span></p>
<p>All three vary in predictable ways over time. They have been calculated very accurately from astronomical considerations (basically the gravity of the Earth, Sun, moon, and other solar system objects).</p>
</section>
</section>
<section id="past-orbital-variations">
<h2>4. Past orbital variations<a class="headerlink" href="#past-orbital-variations" title="Permalink to this heading">#</a></h2>
<p>There are tools in <code class="docutils literal notranslate"><span class="pre">climlab</span></code> to look up orbital parameters for Earth over the last 5 million years.</p>
<p>We will use the package</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">climlab</span><span class="o">.</span><span class="n">solar</span><span class="o">.</span><span class="n">orbital</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">climlab.solar.orbital</span> <span class="kn">import</span> <span class="n">OrbitalTable</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">OrbitalTable</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (kyear: 5001)
Coordinates:
  * kyear       (kyear) int64 0 -1 -2 -3 -4 -5 ... -4996 -4997 -4998 -4999 -5000
Data variables:
    ecc         (kyear) float64 0.01724 0.01764 0.01802 ... 0.02689 0.02685
    long_peri   (kyear) float64 281.4 264.3 247.2 ... -8.361e+04 -8.362e+04
    obliquity   (kyear) float64 23.45 23.57 23.7 23.82 ... 22.55 22.52 22.52
    precession  (kyear) float64 -0.0169 -0.01756 -0.01662 ... -0.02683 -0.02639
    65NJul      (kyear) float64 426.8 430.1 434.7 440.2 ... 407.5 409.1 412.3
    65SJan      (kyear) float64 455.6 455.5 454.1 451.6 ... 452.9 450.6 447.3
    15NJul      (kyear) float64 440.6 442.5 445.6 449.8 ... 431.5 433.5 436.9
    15SJan      (kyear) float64 470.4 468.6 465.5 461.4 ... 479.7 477.5 474.0
Attributes:
    Description:  The Berger and Loutre (1991) orbital data table
    Citation:     https://doi.org/10.1016/0277-3791(91)90033-Q
    Source:       http://www.atmos.albany.edu/facstaff/brose/resources/climla...
    Note:         Longitude of perihelion is defined to be 0 degrees at North...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-fcb2f9d2-5ece-490f-8554-1811993f4b49' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-fcb2f9d2-5ece-490f-8554-1811993f4b49' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>kyear</span>: 5001</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-6d2f0410-83dd-4045-b5f6-bb34472a48dd' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6d2f0410-83dd-4045-b5f6-bb34472a48dd' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>kyear</span></div><div class='xr-var-dims'>(kyear)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 -1 -2 -3 ... -4998 -4999 -5000</div><input id='attrs-ac15713a-d885-41c8-bcf0-0a8ed73f45de' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ac15713a-d885-41c8-bcf0-0a8ed73f45de' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f53efe99-8164-459a-ae19-e90c43262246' class='xr-var-data-in' type='checkbox'><label for='data-f53efe99-8164-459a-ae19-e90c43262246' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([    0,    -1,    -2, ..., -4998, -4999, -5000])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3c2ea666-0cdf-4f3d-882d-b638a3116a4b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3c2ea666-0cdf-4f3d-882d-b638a3116a4b' class='xr-section-summary' >Data variables: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>ecc</span></div><div class='xr-var-dims'>(kyear)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.01724 0.01764 ... 0.02689 0.02685</div><input id='attrs-04cd8194-383c-47eb-b013-9c3787319fb1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-04cd8194-383c-47eb-b013-9c3787319fb1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-baacacac-aa10-41ac-903e-5a3712cf70a0' class='xr-var-data-in' type='checkbox'><label for='data-baacacac-aa10-41ac-903e-5a3712cf70a0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.017236, 0.017644, 0.018024, ..., 0.026988, 0.026892, 0.026851])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>long_peri</span></div><div class='xr-var-dims'>(kyear)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>281.4 264.3 ... -8.362e+04</div><input id='attrs-4e0ff06e-f303-4112-b85b-6b7894b11fd3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4e0ff06e-f303-4112-b85b-6b7894b11fd3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cab237bb-4896-486a-9f30-d338cf219893' class='xr-var-data-in' type='checkbox'><label for='data-cab237bb-4896-486a-9f30-d338cf219893' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([   281.37,    264.26,    247.23, ..., -83591.56, -83606.08,
       -83620.57])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>obliquity</span></div><div class='xr-var-dims'>(kyear)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>23.45 23.57 23.7 ... 22.52 22.52</div><input id='attrs-dbb3cf71-6dd3-402f-afeb-2c6c096c3c8b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dbb3cf71-6dd3-402f-afeb-2c6c096c3c8b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-47f090af-d67b-43f5-9373-bfbadfc87a4f' class='xr-var-data-in' type='checkbox'><label for='data-47f090af-d67b-43f5-9373-bfbadfc87a4f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([23.446, 23.573, 23.697, ..., 22.546, 22.525, 22.525])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>precession</span></div><div class='xr-var-dims'>(kyear)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.0169 -0.01756 ... -0.02639</div><input id='attrs-06c4a1c5-0a0b-43f6-a4ad-53a5106c6708' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-06c4a1c5-0a0b-43f6-a4ad-53a5106c6708' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1cf2fae9-dbc5-4685-bd9e-4137432cad9f' class='xr-var-data-in' type='checkbox'><label for='data-1cf2fae9-dbc5-4685-bd9e-4137432cad9f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-0.0169 , -0.01756, -0.01662, ..., -0.0256 , -0.02683, -0.02639])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>65NJul</span></div><div class='xr-var-dims'>(kyear)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>426.8 430.1 434.7 ... 409.1 412.3</div><input id='attrs-33b77b95-c7ac-4a63-b867-0af48d4486bd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-33b77b95-c7ac-4a63-b867-0af48d4486bd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fb66868f-d93d-45c2-952c-b2cb642a9f12' class='xr-var-data-in' type='checkbox'><label for='data-fb66868f-d93d-45c2-952c-b2cb642a9f12' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([426.76, 430.12, 434.69, ..., 407.47, 409.12, 412.29])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>65SJan</span></div><div class='xr-var-dims'>(kyear)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>455.6 455.5 454.1 ... 450.6 447.3</div><input id='attrs-62c795dd-c23f-41b8-9847-24ab240631fd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-62c795dd-c23f-41b8-9847-24ab240631fd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8022cb12-9dc9-4a6b-9931-5412dbf0bcc4' class='xr-var-data-in' type='checkbox'><label for='data-8022cb12-9dc9-4a6b-9931-5412dbf0bcc4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([455.58, 455.48, 454.07, ..., 452.94, 450.63, 447.34])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>15NJul</span></div><div class='xr-var-dims'>(kyear)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>440.6 442.5 445.6 ... 433.5 436.9</div><input id='attrs-6b0b3ab2-6462-4c07-aae4-58972b744f02' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6b0b3ab2-6462-4c07-aae4-58972b744f02' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5da72a31-fbac-4b82-9a50-0189668a65e8' class='xr-var-data-in' type='checkbox'><label for='data-5da72a31-fbac-4b82-9a50-0189668a65e8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([440.6 , 442.48, 445.62, ..., 431.53, 433.54, 436.89])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>15SJan</span></div><div class='xr-var-dims'>(kyear)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>470.4 468.6 465.5 ... 477.5 474.0</div><input id='attrs-3028615f-1e34-4f4e-9a55-ab777796001d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3028615f-1e34-4f4e-9a55-ab777796001d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-57b29c12-48b8-41c9-9468-2ca4079c4071' class='xr-var-data-in' type='checkbox'><label for='data-57b29c12-48b8-41c9-9468-2ca4079c4071' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([470.35, 468.57, 465.49, ..., 479.68, 477.53, 474.03])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3514ac26-589b-4b38-b57d-3c92e58db088' class='xr-section-summary-in' type='checkbox'  ><label for='section-3514ac26-589b-4b38-b57d-3c92e58db088' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>kyear</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-9374bc08-1da0-412f-aac8-42cf57594707' class='xr-index-data-in' type='checkbox'/><label for='index-9374bc08-1da0-412f-aac8-42cf57594707' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([    0,    -1,    -2,    -3,    -4,    -5,    -6,    -7,    -8,    -9,
       ...
       -4991, -4992, -4993, -4994, -4995, -4996, -4997, -4998, -4999, -5000],
      dtype=&#x27;int64&#x27;, name=&#x27;kyear&#x27;, length=5001))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-65af6bcf-c200-4ef6-b3ea-abfa91017f70' class='xr-section-summary-in' type='checkbox'  checked><label for='section-65af6bcf-c200-4ef6-b3ea-abfa91017f70' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Description :</span></dt><dd>The Berger and Loutre (1991) orbital data table</dd><dt><span>Citation :</span></dt><dd>https://doi.org/10.1016/0277-3791(91)90033-Q</dd><dt><span>Source :</span></dt><dd>http://www.atmos.albany.edu/facstaff/brose/resources/climlab_data/orbital/orbit91</dd><dt><span>Note :</span></dt><dd>Longitude of perihelion is defined to be 0 degrees at Northern Vernal Equinox. This differs by 180 degrees from orbit91 source file.</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Make reference plots of the variation in the three orbital parameter over the last 1 million years</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kyears</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span> <span class="o">-</span><span class="mf">1000.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">kyears</span><span class="p">)</span>
<span class="n">orb</span> <span class="o">=</span> <span class="n">OrbitalTable</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">kyear</span><span class="o">=</span><span class="n">kyears</span><span class="p">)</span>
<span class="n">orb</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-1000.  -999.  -998. ...    -2.    -1.     0.]
</pre></div>
</div>
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (kyear: 1001)
Coordinates:
  * kyear       (kyear) float64 -1e+03 -999.0 -998.0 -997.0 ... -2.0 -1.0 0.0
Data variables:
    ecc         (kyear) float64 0.03576 0.03695 0.03811 ... 0.01764 0.01724
    long_peri   (kyear) float64 -1.644e+04 -1.642e+04 -1.641e+04 ... 264.3 281.4
    obliquity   (kyear) float64 23.78 23.84 23.88 23.9 ... 23.7 23.57 23.45
    precession  (kyear) float64 0.03018 0.02458 0.0166 ... -0.01756 -0.0169
    65NJul      (kyear) float64 478.7 479.0 476.4 470.9 ... 434.7 430.1 426.8
    65SJan      (kyear) float64 414.9 416.2 419.9 425.8 ... 454.1 455.5 455.6
    15NJul      (kyear) float64 489.6 489.1 485.9 480.0 ... 445.6 442.5 440.6
    15SJan      (kyear) float64 424.4 425.0 428.3 434.0 ... 465.5 468.6 470.4
Attributes:
    Description:  The Berger and Loutre (1991) orbital data table
    Citation:     https://doi.org/10.1016/0277-3791(91)90033-Q
    Source:       http://www.atmos.albany.edu/facstaff/brose/resources/climla...
    Note:         Longitude of perihelion is defined to be 0 degrees at North...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-44cf223b-63c7-4362-88ae-62851d04c6a4' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-44cf223b-63c7-4362-88ae-62851d04c6a4' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>kyear</span>: 1001</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-808c2f1a-4c9f-400b-8bd0-8a7afc52edf7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-808c2f1a-4c9f-400b-8bd0-8a7afc52edf7' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>kyear</span></div><div class='xr-var-dims'>(kyear)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1e+03 -999.0 -998.0 ... -1.0 0.0</div><input id='attrs-a1f0c669-bc23-4bf9-bf57-4dc48f5b00d3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a1f0c669-bc23-4bf9-bf57-4dc48f5b00d3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-521717ec-cb65-4a52-b28a-b98fa35ab57e' class='xr-var-data-in' type='checkbox'><label for='data-521717ec-cb65-4a52-b28a-b98fa35ab57e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-1000.,  -999.,  -998., ...,    -2.,    -1.,     0.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-27eadeec-1f5f-4bc0-b480-076aa294ecc0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-27eadeec-1f5f-4bc0-b480-076aa294ecc0' class='xr-section-summary' >Data variables: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>ecc</span></div><div class='xr-var-dims'>(kyear)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.03576 0.03695 ... 0.01764 0.01724</div><input id='attrs-0dc0433d-b212-4c4b-b405-9f61f76d7010' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0dc0433d-b212-4c4b-b405-9f61f76d7010' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-307a2d61-e2d3-4fe6-a9bb-f5681a3ff2d8' class='xr-var-data-in' type='checkbox'><label for='data-307a2d61-e2d3-4fe6-a9bb-f5681a3ff2d8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.035765, 0.036953, 0.038114, ..., 0.018024, 0.017644, 0.017236])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>long_peri</span></div><div class='xr-var-dims'>(kyear)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1.644e+04 -1.642e+04 ... 281.4</div><input id='attrs-3f5a5830-3e43-46df-8113-9493f7022fb1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3f5a5830-3e43-46df-8113-9493f7022fb1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-24effef8-f16f-459f-a15c-4a27d15900cd' class='xr-var-data-in' type='checkbox'><label for='data-24effef8-f16f-459f-a15c-4a27d15900cd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-16437.54, -16421.71, -16405.83, ...,    247.23,    264.26,
          281.37])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>obliquity</span></div><div class='xr-var-dims'>(kyear)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>23.78 23.84 23.88 ... 23.57 23.45</div><input id='attrs-09214802-8c05-4b2c-bc9c-4b1cace50dc1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-09214802-8c05-4b2c-bc9c-4b1cace50dc1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb22fa43-a6f5-4f45-9c90-64d03315b464' class='xr-var-data-in' type='checkbox'><label for='data-eb22fa43-a6f5-4f45-9c90-64d03315b464' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([23.778, 23.835, 23.877, ..., 23.697, 23.573, 23.446])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>precession</span></div><div class='xr-var-dims'>(kyear)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.03018 0.02458 ... -0.0169</div><input id='attrs-19124d41-3d05-4190-915d-d5fcc8329c55' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-19124d41-3d05-4190-915d-d5fcc8329c55' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dfcb9664-7882-46e9-92a3-3272a3af1c87' class='xr-var-data-in' type='checkbox'><label for='data-dfcb9664-7882-46e9-92a3-3272a3af1c87' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0.03018,  0.02458,  0.0166 , ..., -0.01662, -0.01756, -0.0169 ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>65NJul</span></div><div class='xr-var-dims'>(kyear)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>478.7 479.0 476.4 ... 430.1 426.8</div><input id='attrs-1e18d513-09fa-46de-9a17-adb84003ffd5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1e18d513-09fa-46de-9a17-adb84003ffd5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6239fc7c-db61-4edb-8456-e52c11d60725' class='xr-var-data-in' type='checkbox'><label for='data-6239fc7c-db61-4edb-8456-e52c11d60725' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([478.69, 478.97, 476.36, ..., 434.69, 430.12, 426.76])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>65SJan</span></div><div class='xr-var-dims'>(kyear)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>414.9 416.2 419.9 ... 455.5 455.6</div><input id='attrs-9a2b5063-14c5-4ca6-85a6-4b78e7e5b3c6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9a2b5063-14c5-4ca6-85a6-4b78e7e5b3c6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-05d1184c-853f-487e-b5c0-aa2855320894' class='xr-var-data-in' type='checkbox'><label for='data-05d1184c-853f-487e-b5c0-aa2855320894' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([414.92, 416.23, 419.89, ..., 454.07, 455.48, 455.58])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>15NJul</span></div><div class='xr-var-dims'>(kyear)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>489.6 489.1 485.9 ... 442.5 440.6</div><input id='attrs-cf88c4d7-465b-4ba5-9aae-755bbdbf529c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cf88c4d7-465b-4ba5-9aae-755bbdbf529c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6e6eaf0c-e860-449f-9367-a2d0ff83d6a2' class='xr-var-data-in' type='checkbox'><label for='data-6e6eaf0c-e860-449f-9367-a2d0ff83d6a2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([489.61, 489.11, 485.86, ..., 445.62, 442.48, 440.6 ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>15SJan</span></div><div class='xr-var-dims'>(kyear)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>424.4 425.0 428.3 ... 468.6 470.4</div><input id='attrs-3a13240d-a824-4ef6-b96d-925980693a53' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3a13240d-a824-4ef6-b96d-925980693a53' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d125a8dc-9bc9-4c93-b9a2-78c4c90b879d' class='xr-var-data-in' type='checkbox'><label for='data-d125a8dc-9bc9-4c93-b9a2-78c4c90b879d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([424.37, 425.04, 428.27, ..., 465.49, 468.57, 470.35])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6f5de86c-122f-43ed-b707-a6c85141d9c9' class='xr-section-summary-in' type='checkbox'  ><label for='section-6f5de86c-122f-43ed-b707-a6c85141d9c9' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>kyear</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-162187d7-76e7-463d-bf14-04697a45fbca' class='xr-index-data-in' type='checkbox'/><label for='index-162187d7-76e7-463d-bf14-04697a45fbca' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-1000.0,  -999.0,  -998.0,  -997.0,  -996.0,  -995.0,  -994.0,  -993.0,
        -992.0,  -991.0,
       ...
          -9.0,    -8.0,    -7.0,    -6.0,    -5.0,    -4.0,    -3.0,    -2.0,
          -1.0,     0.0],
      dtype=&#x27;float64&#x27;, name=&#x27;kyear&#x27;, length=1001))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-aea899c6-76ef-42b6-a1a8-8c763420c50e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-aea899c6-76ef-42b6-a1a8-8c763420c50e' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Description :</span></dt><dd>The Berger and Loutre (1991) orbital data table</dd><dt><span>Citation :</span></dt><dd>https://doi.org/10.1016/0277-3791(91)90033-Q</dd><dt><span>Source :</span></dt><dd>http://www.atmos.albany.edu/facstaff/brose/resources/climlab_data/orbital/orbit91</dd><dt><span>Note :</span></dt><dd>Longitude of perihelion is defined to be 0 degrees at Northern Vernal Equinox. This differs by 180 degrees from orbit91 source file.</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>The object called</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">orb</span>
</pre></div>
</div>
<p>is an <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> which now holds 1 million years worth of orbital data, total of 1001 data points for each element:</p>
<ul class="simple">
<li><p>eccentricity <code class="docutils literal notranslate"><span class="pre">ecc</span></code></p></li>
<li><p>obliquity angle <code class="docutils literal notranslate"><span class="pre">obliquity</span></code></p></li>
<li><p>solar longitude of perihelion <code class="docutils literal notranslate"><span class="pre">long_peri</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span> <span class="p">)</span>

<span class="n">ax1</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">kyears</span><span class="p">,</span> <span class="n">orb</span><span class="p">[</span><span class="s1">&#39;ecc&#39;</span><span class="p">]</span> <span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Eccentricity $e$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">kyears</span><span class="p">,</span> <span class="n">orb</span><span class="p">[</span><span class="s1">&#39;ecc&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span> <span class="n">orb</span><span class="p">[</span><span class="s1">&#39;long_peri&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Precessional parameter $e \sin(\Lambda)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span> <span class="p">)</span>

<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">kyears</span><span class="p">,</span> <span class="n">orb</span><span class="p">[</span><span class="s1">&#39;obliquity&#39;</span><span class="p">]</span> <span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Obliquity (axial tilt) $\Phi$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span> <span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span> <span class="s1">&#39;Thousands of years before present&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;plot.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/674f982629866c0ab26aa5710a3a0014c748b8e9bc9247719d684f94e8ea561a.png" src="../_images/674f982629866c0ab26aa5710a3a0014c748b8e9bc9247719d684f94e8ea561a.png" />
</div>
</div>
<section id="timescales-of-orbital-variation">
<h3>Timescales of orbital variation:<a class="headerlink" href="#timescales-of-orbital-variation" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Eccentricity varies slowly between nearly circular and slightly eccentric, with dominant periodicities of about 100 and 400 kyear. Current eccentricity is relatively small compared to previous few million years</p></li>
<li><p>Longitude of perihelion has a period around 20 kyears, but effect is modulated by slow eccentricity variations. Precessional cycles are predicted to be small for the coming 50 kyears because of weak eccentricity.</p></li>
<li><p>Obliquity varies between about 22.5 and 24.5 over a period of 40 kyears. It is currently near the middle of its range.</p></li>
</ul>
</section>
</section>
<section id="using-climlab-to-calculate-insolation-for-arbitrary-orbital-parameters">
<h2>5. Using <code class="docutils literal notranslate"><span class="pre">climlab</span></code> to calculate insolation for arbitrary orbital parameters<a class="headerlink" href="#using-climlab-to-calculate-insolation-for-arbitrary-orbital-parameters" title="Permalink to this heading">#</a></h2>
<p>We can use the function</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">climlab</span><span class="o">.</span><span class="n">solar</span><span class="o">.</span><span class="n">insolation</span><span class="o">.</span><span class="n">daily_insolation</span><span class="p">()</span>
</pre></div>
</div>
<p>to calculate insolation for any arbitrary orbital parameters.</p>
<p>We just need to pass a dictionary of orbital parameters. This works automatically when we slice or interpolate from the <code class="docutils literal notranslate"><span class="pre">xarray</span></code> object <code class="docutils literal notranslate"><span class="pre">OrbitalTable</span></code>.</p>
<section id="an-example-zero-obliquity">
<h3>An example: zero obliquity<a class="headerlink" href="#an-example-zero-obliquity" title="Permalink to this heading">#</a></h3>
<p>Calculate the insolation at the <strong>North Pole</strong> for a planet with <strong>zero obliquity and eccentricity</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">climlab.solar.insolation</span> <span class="kn">import</span> <span class="n">daily_insolation</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">thisorb</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ecc&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;obliquity&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;long_peri&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="n">thisorb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;ecc&#39;: 0.0, &#39;obliquity&#39;: 0.0, &#39;long_peri&#39;: 0.0}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">days</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">20.</span><span class="p">)</span><span class="o">/</span><span class="mi">20</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">days_per_year</span>

<span class="n">daily_insolation</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">thisorb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (day: 50)&gt;
array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
Coordinates:
  * day      (day) float64 18.26 25.34 32.42 39.51 ... 344.0 351.1 358.2 365.2</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>day</span>: 50</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-76eaf9c2-6922-4dae-92e3-1903bb6fb72a' class='xr-array-in' type='checkbox' checked><label for='section-76eaf9c2-6922-4dae-92e3-1903bb6fb72a' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0</span></div><div class='xr-array-data'><pre>array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])</pre></div></div></li><li class='xr-section-item'><input id='section-c255abf8-fb98-4283-81db-1c40bbc42a9e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c255abf8-fb98-4283-81db-1c40bbc42a9e' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>day</span></div><div class='xr-var-dims'>(day)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>18.26 25.34 32.42 ... 358.2 365.2</div><input id='attrs-21f7c593-ca19-4814-b522-13e4716b1767' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-21f7c593-ca19-4814-b522-13e4716b1767' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7d64347d-e8f8-4d6a-8289-5d256e27c389' class='xr-var-data-in' type='checkbox'><label for='data-7d64347d-e8f8-4d6a-8289-5d256e27c389' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 18.26211 ,  25.343336,  32.424563,  39.505789,  46.587015,  53.668242,
        60.749468,  67.830694,  74.911921,  81.993147,  89.074373,  96.1556  ,
       103.236826, 110.318052, 117.399279, 124.480505, 131.561731, 138.642958,
       145.724184, 152.80541 , 159.886637, 166.967863, 174.049089, 181.130316,
       188.211542, 195.292768, 202.373994, 209.455221, 216.536447, 223.617673,
       230.6989  , 237.780126, 244.861352, 251.942579, 259.023805, 266.105031,
       273.186258, 280.267484, 287.34871 , 294.429937, 301.511163, 308.592389,
       315.673616, 322.754842, 329.836068, 336.917295, 343.998521, 351.079747,
       358.160974, 365.2422  ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6993ad66-2870-4a4e-926d-60f8445678a0' class='xr-section-summary-in' type='checkbox'  ><label for='section-6993ad66-2870-4a4e-926d-60f8445678a0' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>day</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e628e7bd-c869-4cad-8d9b-185d0d04f1f6' class='xr-index-data-in' type='checkbox'/><label for='index-e628e7bd-c869-4cad-8d9b-185d0d04f1f6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([18.262110000000003, 25.343336326530615,  32.42456265306122,
        39.50578897959184,  46.58701530612245,  53.66824163265306,
       60.749467959183676,  67.83069428571429,   74.9119206122449,
        81.99314693877551,  89.07437326530612,  96.15559959183673,
       103.23682591836736, 110.31805224489796, 117.39927857142858,
       124.48050489795918,  131.5617312244898, 138.64295755102043,
         145.724183877551, 152.80541020408165, 159.88663653061224,
       166.96786285714288,  174.0490891836735, 181.13031551020407,
       188.21154183673468, 195.29276816326532, 202.37399448979593,
       209.45522081632654, 216.53644714285716, 223.61767346938777,
       230.69889979591838, 237.78012612244896, 244.86135244897957,
       251.94257877551024,  259.0238051020408,  266.1050314285714,
        273.1862577551021,  280.2674840816327,  287.3487104081633,
        294.4299367346939, 301.51116306122447,  308.5923893877552,
        315.6736157142857,  322.7548420408163, 329.83606836734697,
        336.9172946938776, 343.99852102040813,  351.0797473469388,
        358.1609736734694,           365.2422],
      dtype=&#x27;float64&#x27;, name=&#x27;day&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c3ea4cab-d826-4e44-b433-8d81cdba18ef' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-c3ea4cab-d826-4e44-b433-8d81cdba18ef' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Compare this with the same calculation for default (present-day) orbital parameters:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">daily_insolation</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="n">days</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (day: 50)&gt;
array([  0.        ,   0.        ,   0.        ,   0.        ,
         0.        ,   0.        ,   0.        ,   0.        ,
         0.        ,  18.86214697,  85.00612352, 149.06416099,
       210.14318852, 267.43771123, 320.2345592 , 367.91459762,
       409.95198005, 445.91155305, 475.44500661, 498.28632029,
       514.24699096, 523.21145124, 525.13300552, 520.03052731,
       507.9860795 , 489.14354007, 463.70823983, 431.94754511,
       394.19224658, 350.83854561, 302.35036042, 249.26160895,
       192.17806354, 131.7783206 ,  68.81338909,   4.10438408,
         0.        ,   0.        ,   0.        ,   0.        ,
         0.        ,   0.        ,   0.        ,   0.        ,
         0.        ,   0.        ,   0.        ,   0.        ,
         0.        ,   0.        ])
Coordinates:
  * day      (day) float64 18.26 25.34 32.42 39.51 ... 344.0 351.1 358.2 365.2</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>day</span>: 50</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-ceef6548-e5d6-405d-a043-082c020ee6c0' class='xr-array-in' type='checkbox' checked><label for='section-ceef6548-e5d6-405d-a043-082c020ee6c0' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0</span></div><div class='xr-array-data'><pre>array([  0.        ,   0.        ,   0.        ,   0.        ,
         0.        ,   0.        ,   0.        ,   0.        ,
         0.        ,  18.86214697,  85.00612352, 149.06416099,
       210.14318852, 267.43771123, 320.2345592 , 367.91459762,
       409.95198005, 445.91155305, 475.44500661, 498.28632029,
       514.24699096, 523.21145124, 525.13300552, 520.03052731,
       507.9860795 , 489.14354007, 463.70823983, 431.94754511,
       394.19224658, 350.83854561, 302.35036042, 249.26160895,
       192.17806354, 131.7783206 ,  68.81338909,   4.10438408,
         0.        ,   0.        ,   0.        ,   0.        ,
         0.        ,   0.        ,   0.        ,   0.        ,
         0.        ,   0.        ,   0.        ,   0.        ,
         0.        ,   0.        ])</pre></div></div></li><li class='xr-section-item'><input id='section-2aae6e6d-edea-48a8-a89f-90f7287935bc' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2aae6e6d-edea-48a8-a89f-90f7287935bc' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>day</span></div><div class='xr-var-dims'>(day)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>18.26 25.34 32.42 ... 358.2 365.2</div><input id='attrs-76e17a69-477a-4e47-93ce-bcf259b2a863' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-76e17a69-477a-4e47-93ce-bcf259b2a863' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-18a878de-3513-4f6a-b880-5bf5205419ff' class='xr-var-data-in' type='checkbox'><label for='data-18a878de-3513-4f6a-b880-5bf5205419ff' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 18.26211 ,  25.343336,  32.424563,  39.505789,  46.587015,  53.668242,
        60.749468,  67.830694,  74.911921,  81.993147,  89.074373,  96.1556  ,
       103.236826, 110.318052, 117.399279, 124.480505, 131.561731, 138.642958,
       145.724184, 152.80541 , 159.886637, 166.967863, 174.049089, 181.130316,
       188.211542, 195.292768, 202.373994, 209.455221, 216.536447, 223.617673,
       230.6989  , 237.780126, 244.861352, 251.942579, 259.023805, 266.105031,
       273.186258, 280.267484, 287.34871 , 294.429937, 301.511163, 308.592389,
       315.673616, 322.754842, 329.836068, 336.917295, 343.998521, 351.079747,
       358.160974, 365.2422  ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2aabd616-8b69-4120-a633-6e7a30093e25' class='xr-section-summary-in' type='checkbox'  ><label for='section-2aabd616-8b69-4120-a633-6e7a30093e25' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>day</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-7544c3c4-34a5-472e-b911-f2a617babb4c' class='xr-index-data-in' type='checkbox'/><label for='index-7544c3c4-34a5-472e-b911-f2a617babb4c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([18.262110000000003, 25.343336326530615,  32.42456265306122,
        39.50578897959184,  46.58701530612245,  53.66824163265306,
       60.749467959183676,  67.83069428571429,   74.9119206122449,
        81.99314693877551,  89.07437326530612,  96.15559959183673,
       103.23682591836736, 110.31805224489796, 117.39927857142858,
       124.48050489795918,  131.5617312244898, 138.64295755102043,
         145.724183877551, 152.80541020408165, 159.88663653061224,
       166.96786285714288,  174.0490891836735, 181.13031551020407,
       188.21154183673468, 195.29276816326532, 202.37399448979593,
       209.45522081632654, 216.53644714285716, 223.61767346938777,
       230.69889979591838, 237.78012612244896, 244.86135244897957,
       251.94257877551024,  259.0238051020408,  266.1050314285714,
        273.1862577551021,  280.2674840816327,  287.3487104081633,
        294.4299367346939, 301.51116306122447,  308.5923893877552,
        315.6736157142857,  322.7548420408163, 329.83606836734697,
        336.9172946938776, 343.99852102040813,  351.0797473469388,
        358.1609736734694,           365.2422],
      dtype=&#x27;float64&#x27;, name=&#x27;day&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-64e0502b-bab2-433d-a200-964fef250b47' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-64e0502b-bab2-433d-a200-964fef250b47' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Do you understand whats going on here?</p>
</section>
</section>
<section id="past-changes-in-insolation-investigating-the-milankovitch-hypothesis">
<h2>6. Past changes in insolation: investigating the Milankovitch hypothesis<a class="headerlink" href="#past-changes-in-insolation-investigating-the-milankovitch-hypothesis" title="Permalink to this heading">#</a></h2>
<p>The <strong>Last Glacial Maximum</strong> or LGM occurred around 23,000 years before present, when the ice sheets were at their greatest extent.</p>
<p>By 10,000 years ago, the ice sheets were mostly gone and the last ice age was over.</p>
<p>If the <strong>Milankovitch hypothesis</strong> is correct, we should that <strong>summer insolation in the high northern latitudes</strong> increased substantially after the LGM.</p>
<p>The classical way to plot this is the look at <strong>insolation at summer solstice at 65N</strong>.  Lets plot this for the last 100,000 years.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  Plot summer solstice insolation at 65N</span>

<span class="n">kyears100</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>  <span class="c1">#  last 100 kyr</span>
<span class="n">thisorb</span> <span class="o">=</span> <span class="n">OrbitalTable</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">kyear</span><span class="o">=</span><span class="n">kyears100</span><span class="p">)</span>
<span class="c1"># first 65=latitude </span>
<span class="c1"># second 172 day of year </span>
<span class="n">S65</span> <span class="o">=</span> <span class="n">daily_insolation</span><span class="p">(</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">172</span><span class="p">,</span> <span class="n">thisorb</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S65</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kyears100</span><span class="p">,</span> <span class="n">S65</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Thousands of years before present&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;W/m2&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Summer solstice insolation at 65N&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.DataArray (kyear: 101)&gt;
array([498.80375813, 489.01652477, 480.9736246 , 475.3502372 ,
       472.2993669 , 471.77014222, 473.41491328, 476.88238506,
       481.71637865, 487.5535188 , 494.02933045, 500.8172215 ,
       507.60502296, 514.03794513, 519.72839453, 524.18459749,
       526.88818882, 527.31498761, 525.12731424, 520.26440099,
       512.97325288, 503.90310504, 493.88961057, 483.85946184,
       474.60972819, 466.80827497, 460.84556162, 456.91158754,
       455.01008584, 455.05498997, 456.83533549, 460.10625584,
       464.61664832, 470.0812763 , 476.24469622, 482.76915403,
       489.37529882, 495.71509717, 501.47781924, 506.35086965,
       510.11431306, 512.6118726 , 513.84752665, 513.88974921,
       512.96185562, 511.29158609, 509.19938758, 506.92430447,
       504.68831494, 502.63129842, 500.87843695, 499.44012914,
       498.31547751, 497.5029162 , 496.96147228, 496.63872361,
       496.49184725, 496.50663619, 496.64846569, 496.87392298,
       497.17828287, 497.49832129, 497.76826152, 497.90450296,
       497.79616493, 497.28260953, 496.21327019, 494.43784106,
       491.84687581, 488.44731105, 484.33284194, 479.78139543,
       475.13202835, 470.82223114, 467.30625982, 464.94659708,
       464.04012809, 464.71360749, 467.01182992, 470.83601977,
       476.0017198 , 482.28701237, 489.37366141, 496.92573779,
       504.59665857, 511.92465686, 518.48117328, 523.7717273 ,
       527.3444343 , 528.82231027, 527.97485582, 524.87702832,
       519.81679294, 513.38066041, 506.22510927, 499.05977296,
       492.51031214, 487.03935919, 482.90505474, 480.2196011 ,
       478.94375843])
Coordinates:
  * kyear    (kyear) float64 -100.0 -99.0 -98.0 -97.0 ... -3.0 -2.0 -1.0 0.0
</pre></div>
</div>
<img alt="../_images/8465b920444e71df1e0bcb57d5cdd30bc39e9ea8dd476270a4455cbd30ca0757.png" src="../_images/8465b920444e71df1e0bcb57d5cdd30bc39e9ea8dd476270a4455cbd30ca0757.png" />
</div>
</div>
<p>Indeed, there was an increase of 60 W m<span class="math notranslate nohighlight">\(^{-2}\)</span> over a 10 kyr interval following the LGM.</p>
<p>Why?</p>
<p>What orbital factors favor high insolation at 65N at summer solstice?</p>
<ul class="simple">
<li><p>high obliquity (greater tilt towards sun)</p></li>
<li><p>large, positive precessional parameter (Earth closest to sun)</p></li>
</ul>
<p>Looking back at our plots of the orbital parameters, it turns out that both were optimal around 10,000 years ago.</p>
<p>Actually 10,000 years ago the climate was slightly warmer than today and the ice sheets had mostly disappeared already.</p>
<p>The LGM occurred near a minimum in summer insolation in the north  mostly due to obliquity reaching a minimum, since we have been in a period of weak precession due to the nearly circular orbit. So this is consistent with the orbital theory.</p>
<p>The hypothesis is incomplete, but compelling.</p>
<section id="comparing-insolation-at-10-kyr-and-23-kyr">
<h3>Comparing insolation at 10 kyr and 23 kyr<a class="headerlink" href="#comparing-insolation-at-10-kyr-and-23-kyr" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">181</span><span class="p">)</span>

<span class="n">days</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">50.</span><span class="p">)</span><span class="o">/</span><span class="mi">50</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">days_per_year</span>

<span class="n">orb_0</span> <span class="o">=</span> <span class="n">OrbitalTable</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">kyear</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># present-day orbital parameters</span>
<span class="n">orb_10</span> <span class="o">=</span> <span class="n">OrbitalTable</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">kyear</span><span class="o">=-</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># orbital parameters for 10 kyrs before present</span>
<span class="n">orb_23</span> <span class="o">=</span> <span class="n">OrbitalTable</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">kyear</span><span class="o">=-</span><span class="mi">23</span><span class="p">)</span>   <span class="c1"># 23 kyrs before present</span>

<span class="n">Q_0</span> <span class="o">=</span> <span class="n">daily_insolation</span><span class="p">(</span> <span class="n">lat</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">orb_0</span> <span class="p">)</span>    
<span class="n">Q_10</span> <span class="o">=</span> <span class="n">daily_insolation</span><span class="p">(</span> <span class="n">lat</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">orb_10</span> <span class="p">)</span>   <span class="c1"># insolation arrays for each of the three sets of orbital parameters</span>
<span class="n">Q_23</span> <span class="o">=</span> <span class="n">daily_insolation</span><span class="p">(</span> <span class="n">lat</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">orb_23</span> <span class="p">)</span>

<span class="c1"># Qlist=[]</span>
<span class="c1"># for y in [0,-10,-23]:</span>
<span class="c1">#    Qlist.append(daily_insolation(lat,days,OrbitalTable.interp(kyear=y)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="p">)</span>


<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Qdiff</span> <span class="o">=</span> <span class="n">Q_10</span> <span class="o">-</span> <span class="n">Q_23</span>
<span class="n">CS1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span> <span class="n">days</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">Qdiff</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">100.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span> <span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS1</span><span class="p">,</span> <span class="n">CS1</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span> <span class="n">days</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">Qdiff</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span> <span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Days since January 1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span> <span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span> <span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Insolation differences: 10 kyrs - 23 kyrs&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span> <span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">Qdiff</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span> <span class="p">),</span> <span class="n">lat</span> <span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;W m$^{-2}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span> <span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span> <span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39; Annual mean differences&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span> <span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/714920721d34a98eae7e518adbedae543385badf7e813105d14de54dc9cc7d68.png" src="../_images/714920721d34a98eae7e518adbedae543385badf7e813105d14de54dc9cc7d68.png" />
</div>
</div>
<p>This figure shows that the <strong>insolation at summer solstice</strong> does not tell the whole story!</p>
<p>For example, the insolation in <strong>late summer / early fall</strong> apparently got weaker between 23 and 10 kyr (in the high northern latitudes).</p>
<p>The annual mean plot is perfectly symmetric about the equator.</p>
<p>This actually shows a classic obliquity signal: at 10 kyrs, the axis close to its maximum tilt, around 24.2. At 23 kyrs, the tilt was much weaker, only about 22.7. In the annual mean, a stronger tilt means more sunlight to the poles and less to the equator. This is very helpful if you are trying to melt an ice sheet.</p>
<p>Finally, take the <strong>global average</strong> of the difference.  Recall that the cells reduce in size as we move towards the poles, so if we take the simple arithmetic mean we will get the incorrect answer, as it will bias the result towards the poles.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Qdiff</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lat</span><span class="p">)))</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.006510430783269391
</pre></div>
</div>
</div>
</div>
<p>The difference is tiny (and due to very small changes in the eccentricity).</p>
<p><strong>Ice ages are driven by seasonal and latitudinal redistributions of solar energy</strong>, NOT by changes in the total global amount of solar energy!</p>
</section>
</section>
<section id="exercise">
<h2>EXERCISE<a class="headerlink" href="#exercise" title="Permalink to this heading">#</a></h2>
<p>If you recall, 6 Kyr ago, the Sahara was covered by vegetation, and the monsoon penetrated far further north over Africa.  Repeat the previous exercise but comparing the isolation 6000 years ago to the present day.</p>
<p><em>How much more insolation was there at 40N at the summer solstice?</em></p>
</section>
<section id="understanding-the-effects-of-orbital-variations-on-insolation">
<h2>7. Understanding the effects of orbital variations on insolation<a class="headerlink" href="#understanding-the-effects-of-orbital-variations-on-insolation" title="Permalink to this heading">#</a></h2>
<p>We are going to create a figure showing past time variations in three quantities:</p>
<ol class="arabic simple">
<li><p>Global, annual mean insolation</p></li>
<li><p>Annual mean insolation at high northern latitudes</p></li>
<li><p>Summer solstice insolation at high northern latitudes</p></li>
</ol>
<p>which we will compare to the orbital variations we plotted earlier.</p>
<p>Create a large array of insolation over the whole globe, whole year, and for every set of orbital parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">days</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  7.304844  14.609688  21.914532  29.219376  36.52422   43.829064
  51.133908  58.438752  65.743596  73.04844   80.353284  87.658128
  94.962972 102.267816 109.57266  116.877504 124.182348 131.487192
 138.792036 146.09688  153.401724 160.706568 168.011412 175.316256
 182.6211   189.925944 197.230788 204.535632 211.840476 219.14532
 226.450164 233.755008 241.059852 248.364696 255.66954  262.974384
 270.279228 277.584072 284.888916 292.19376  299.498604 306.803448
 314.108292 321.413136 328.71798  336.022824 343.327668 350.632512
 357.937356 365.2422  ]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">)</span>
<span class="n">num</span> <span class="o">=</span> <span class="mf">365.</span>
<span class="n">days</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="n">num</span><span class="p">,</span><span class="mi">365</span><span class="p">)</span><span class="o">/</span><span class="n">num</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">days_per_year</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">daily_insolation</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">orb</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">Q</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(91, 365, 1001)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Qann</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># time average over the year</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Qann</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">kyears</span><span class="p">)</span>
<span class="n">Qglobal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span> <span class="n">kyears</span> <span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">kyears</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">):</span>   <span class="c1"># global area-weighted average</span>
    <span class="n">Qglobal</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span> <span class="n">Qann</span><span class="p">[:,</span><span class="n">n</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lat</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">Qglobal</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(91, 1001)
[-1000.  -999.  -998. ...    -2.    -1.     0.]
(1001,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">orb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.Dataset&gt;
Dimensions:     (kyear: 1001)
Coordinates:
  * kyear       (kyear) float64 -1e+03 -999.0 -998.0 -997.0 ... -2.0 -1.0 0.0
Data variables:
    ecc         (kyear) float64 0.03576 0.03695 0.03811 ... 0.01764 0.01724
    long_peri   (kyear) float64 -1.644e+04 -1.642e+04 -1.641e+04 ... 264.3 281.4
    obliquity   (kyear) float64 23.78 23.84 23.88 23.9 ... 23.7 23.57 23.45
    precession  (kyear) float64 0.03018 0.02458 0.0166 ... -0.01756 -0.0169
    65NJul      (kyear) float64 478.7 479.0 476.4 470.9 ... 434.7 430.1 426.8
    65SJan      (kyear) float64 414.9 416.2 419.9 425.8 ... 454.1 455.5 455.6
    15NJul      (kyear) float64 489.6 489.1 485.9 480.0 ... 445.6 442.5 440.6
    15SJan      (kyear) float64 424.4 425.0 428.3 434.0 ... 465.5 468.6 470.4
Attributes:
    Description:  The Berger and Loutre (1991) orbital data table
    Citation:     https://doi.org/10.1016/0277-3791(91)90033-Q
    Source:       http://www.atmos.albany.edu/facstaff/brose/resources/climla...
    Note:         Longitude of perihelion is defined to be 0 degrees at North...
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># reset to 1000 years compatible with orb</span>
<span class="n">kyears</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span> <span class="o">-</span><span class="mf">1000.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">kyears</span><span class="p">,</span> <span class="n">orb</span><span class="p">[</span><span class="s1">&#39;ecc&#39;</span><span class="p">]</span> <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Eccentricity $e$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span> <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">kyears</span><span class="p">,</span> <span class="n">orb</span><span class="p">[</span><span class="s1">&#39;obliquity&#39;</span><span class="p">]</span> <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Obliquity (axial tilt) $\Phi$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span> <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">kyears</span><span class="p">,</span> <span class="n">orb</span><span class="p">[</span><span class="s1">&#39;ecc&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span> <span class="n">orb</span><span class="p">[</span><span class="s1">&#39;long_peri&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Precessional parameter $e \sin(\Lambda)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span> <span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">kyears</span><span class="p">,</span> <span class="n">Qglobal</span> <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Global, annual mean insolation&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span> <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span> <span class="n">useOffset</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">kyears</span><span class="p">,</span> <span class="n">Qann</span><span class="p">[</span><span class="mi">80</span><span class="p">,:]</span> <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Annual mean insolation at 70N&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span> <span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">kyears</span><span class="p">,</span> <span class="n">Q</span><span class="p">[</span><span class="mi">80</span><span class="p">,</span><span class="mi">170</span><span class="p">,:]</span> <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Summer solstice insolation at 70N&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span> <span class="p">)</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]:</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span> <span class="s1">&#39;Thousands of years before present&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4d4451c5375981abe54dc3cd21b9392986fc3c3e7cbc313cab5bab623a3d677a.png" src="../_images/4d4451c5375981abe54dc3cd21b9392986fc3c3e7cbc313cab5bab623a3d677a.png" />
</div>
</div>
<p>We see that</p>
<ol class="arabic simple">
<li><p><strong>Global annual mean</strong> insolation <strong>varies only with eccentricity</strong> (slow), and the variations are <strong>very small</strong>!</p></li>
<li><p><strong>Annual mean</strong> insolation <strong>varies with obliquity</strong> (medium). Annual mean insolation does NOT depend on precession!</p></li>
<li><p>Summer solstice insolation at high northern latitudes is affected by both precession and obliquity. The variations are large.</p></li>
</ol>
</section>
<section id="summary">
<h2>8. Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>The annual, global mean insolation varies only as a result of eccentricity <span class="math notranslate nohighlight">\(e\)</span>. The changes are very small (about 0.1 % through a typical eccentricity cycle from more circular to more elliptical)</p></li>
<li><p>Obliquity controls the annual-mean equator-to-pole insolation gradient.</p></li>
<li><p>The precessional parameter <span class="math notranslate nohighlight">\(e \sin\Lambda\)</span> controls the modulation in seasonal insolation due to eccentricity and longitude of perihelion <span class="math notranslate nohighlight">\(\Lambda\)</span>.</p></li>
</ul>
<ul class="simple">
<li><p>The combined effects can result in 15% changes in high-latitude summer insolation</p></li>
<li><p>Obliquity combined with eccentricity and longitude of perihelion control the amplitude of seasonal insolation variations at a point.</p></li>
<li><p>Combined effects of the three orbital parameters can cause variations in seasonal insolation as large as 30% in high latitudes.</p></li>
</ul>
<p>These geometrical considerations tell us that <strong>seasonal variations in <span class="math notranslate nohighlight">\(Q\)</span> can be rather large</strong>, and will surely impact the climate. But to go from there to understanding how large ice sheets come and go is a difficult step, and requires climate models!</p>
<p>One thing is clear: any serious astronomical theory of climate needs to take account of the climate response to seasonal variations in Q, because these are much larger than the variations in annual mean insolation.</p>
</section>
<section id="credits">
<h2>Credits<a class="headerlink" href="#credits" title="Permalink to this heading">#</a></h2>
<p>Adrian Tompkins forked this notebook April 23rd 2021.</p>
<p>This notebook is part of <a class="reference external" href="https://brian-rose.github.io/ClimateLaboratoryBook">The Climate Laboratory</a>, an open-source textbook developed and maintained by <a class="reference external" href="http://www.atmos.albany.edu/facstaff/brose/index.html">Brian E. J. Rose</a>, University at Albany.</p>
<p>It is licensed for free and open consumption under the
<a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International (CC BY 4.0)</a> license.</p>
<p>Development of these notes and the <a class="reference external" href="https://github.com/brian-rose/climlab">climlab software</a> is partially supported by the National Science Foundation under award AGS-1455071 to Brian Rose. Any opinions, findings, conclusions or recommendations expressed here are mine and do not necessarily reflect the views of the National Science Foundation.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "None/None",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="radn_rce.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Radiative-Convective Equilibrium</p>
      </div>
    </a>
    <a class="right-next"
       href="../content_feedbacks.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 3: Climate feedbacks</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-ice-ages">1. The ice ages</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extent-of-glaciation">Extent of glaciation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pacing-of-ice-ages-evidence-from-ocean-sediments">Pacing of ice ages: evidence from ocean sediments</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-the-astronomical-theory-of-the-ice-ages">2. Introducing the astronomical theory of the ice ages</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-milankovitch-hypothesis">The Milankovitch hypothesis</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ellipses-and-orbits">3. Ellipses and orbits</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#perihelion-and-aphelion">Perihelion and Aphelion</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eccentricity">Eccentricity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#obliquity">Obliquity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#longitude-of-perihelion-and-precession-of-the-equinoxes">Longitude of perihelion and precession of the equinoxes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-three-orbital-parameters">The three orbital parameters</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#past-orbital-variations">4. Past orbital variations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#timescales-of-orbital-variation">Timescales of orbital variation:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-climlab-to-calculate-insolation-for-arbitrary-orbital-parameters">5. Using <code class="docutils literal notranslate"><span class="pre">climlab</span></code> to calculate insolation for arbitrary orbital parameters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#an-example-zero-obliquity">An example: zero obliquity</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#past-changes-in-insolation-investigating-the-milankovitch-hypothesis">6. Past changes in insolation: investigating the Milankovitch hypothesis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-insolation-at-10-kyr-and-23-kyr">Comparing insolation at 10 kyr and 23 kyr</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">EXERCISE</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-effects-of-orbital-variations-on-insolation">7. Understanding the effects of orbital variations on insolation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">8. Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#credits">Credits</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Adrian Tompkins
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
       Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>